# Kraken - Decentralized Messaging Platform

## Project Flowchart (Simplified for General Understanding)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                KRAKEN MESSAGING APP                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

1. USER AUTHENTICATION FLOW
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚   Landing   â”‚â”€â”€â”€â–¶â”‚   Connect    â”‚â”€â”€â”€â–¶â”‚   Sign Up /     â”‚â”€â”€â”€â–¶â”‚   Main App   â”‚
   â”‚    Page     â”‚    â”‚   MetaMask   â”‚    â”‚     Login       â”‚    â”‚   Dashboard  â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚                      â”‚
                             â–¼                      â–¼
                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                      â”‚   Wallet     â”‚    â”‚   ID Verificationâ”‚
                      â”‚  Connection  â”‚    â”‚   (PAN Card)    â”‚
                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚                      â”‚
                             â–¼                      â–¼
                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                      â”‚  Supabase    â”‚    â”‚   Profile       â”‚
                      â”‚    Auth      â”‚    â”‚   Creation      â”‚
                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

2. MESSAGING SYSTEM FLOW
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚   Message   â”‚â”€â”€â”€â–¶â”‚   Gun.js     â”‚â”€â”€â”€â–¶â”‚   Real-time     â”‚
   â”‚   Compose   â”‚    â”‚   P2P Send   â”‚    â”‚   Delivery      â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                   â”‚                      â”‚
          â–¼                   â–¼                      â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Encryption  â”‚    â”‚   Local      â”‚    â”‚   Recipient     â”‚
   â”‚  (Optional) â”‚    â”‚   Storage    â”‚    â”‚   Receives      â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                   â”‚                      â”‚
          â–¼                   â–¼                      â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚   ECDH Key  â”‚    â”‚   Message    â”‚    â”‚   Decryption    â”‚
   â”‚  Exchange   â”‚    â”‚   Backup     â”‚    â”‚   & Display     â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

3. DATA STORAGE ARCHITECTURE
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚   User      â”‚â”€â”€â”€â–¶â”‚   Supabase   â”‚â”€â”€â”€â–¶â”‚   Database      â”‚
   â”‚   Data      â”‚    â”‚   Backend    â”‚    â”‚   Tables        â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                   â”‚                      â”‚
          â–¼                   â–¼                      â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  Profiles   â”‚    â”‚ Conversationsâ”‚    â”‚   Messages      â”‚
   â”‚   Table     â”‚    â”‚    Table     â”‚    â”‚    Table        â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                   â”‚                      â”‚
          â–¼                   â–¼                      â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  Username   â”‚    â”‚ Participants â”‚    â”‚   Content       â”‚
   â”‚    Bio      â”‚    â”‚ Last Message â”‚    â”‚   Encryption    â”‚
   â”‚   Avatar    â”‚    â”‚   Metadata   â”‚    â”‚    Status       â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

4. SECURITY & ENCRYPTION FLOW
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚   User A    â”‚â”€â”€â”€â–¶â”‚   Public Key â”‚â”€â”€â”€â–¶â”‚   User B        â”‚
   â”‚  Generates  â”‚    â”‚   Exchange   â”‚    â”‚   Receives      â”‚
   â”‚  Key Pair   â”‚    â”‚  (Gun.js)    â”‚    â”‚   Public Key    â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                   â”‚                      â”‚
          â–¼                   â–¼                      â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚   ECDH      â”‚    â”‚   Shared     â”‚    â”‚   AES-GCM       â”‚
   â”‚ Algorithm   â”‚    â”‚    Key       â”‚    â”‚  Encryption     â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                   â”‚                      â”‚
          â–¼                   â–¼                      â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  Message    â”‚    â”‚   Encrypted  â”‚    â”‚   Secure        â”‚
   â”‚ Encryption  â”‚    â”‚   Content    â”‚    â”‚ Transmission    â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

5. APPLICATION FEATURES FLOW
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚    Home     â”‚â”€â”€â”€â–¶â”‚   Messages   â”‚â”€â”€â”€â–¶â”‚   Profile       â”‚
   â”‚ Dashboard   â”‚    â”‚    Page      â”‚    â”‚   Settings      â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                   â”‚                      â”‚
          â–¼                   â–¼                      â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚   Wallet    â”‚    â”‚ Conversation â”‚    â”‚   Avatar        â”‚
   â”‚   Viewer    â”‚    â”‚    List      â”‚    â”‚   Upload        â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                   â”‚                      â”‚
          â–¼                   â–¼                      â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Crypto      â”‚    â”‚   Message    â”‚    â”‚   Bio &         â”‚
   â”‚ Prices      â”‚    â”‚   History    â”‚    â”‚   Username      â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## UNUSED/UNNECESSARY FILES IN PROJECT

### Files that are never used or imported:
1. **src/components/CreateGroupChat.tsx** - Group chat functionality not implemented
2. **src/components/FileUpload.tsx** - File upload feature not used in messaging
3. **src/components/WalletConnect.tsx** - Replaced by login system
4. **src/lib/crypto.ts** - Duplicate crypto functionality (replaced by messagingService)
5. **src/lib/ipfs.ts** - IPFS integration not implemented
6. **src/lib/web3.ts** - Some functions not used (uploadToIPFS)
7. **src/pages/Search.tsx** - Search functionality not implemented
8. **errors.txt** - Documentation file, not part of app
9. **gunjs&user authentication.txt** - Documentation file, not part of app
10. **eslint.config.js** - Development tool, not used in production

### Database migrations that could be consolidated:
- Multiple migration files (20+ files) that could be merged into fewer migrations
- Some migrations fix issues from previous migrations (could be simplified)

### Redundant or unused dependencies in package.json:
- **react-query** - Not used in the current implementation
- **web3.storage** - IPFS functionality not implemented
- **viem** and **wagmi** - Web3 libraries not used
- **socket.io-client** - Not used (Gun.js handles real-time)
- **lightweight-charts** - Only used in wallet page
- **zustand** - State management not implemented

---

# README

## Kraken - Decentralized Messaging Platform

Kraken is a secure, decentralized messaging application built on Web3 technologies. It enables users to send encrypted messages using their Ethereum wallet addresses as identities, with real-time peer-to-peer communication powered by Gun.js.

### ğŸš€ Features

- **Wallet-Based Authentication**: Connect using MetaMask wallet
- **End-to-End Encryption**: Messages encrypted using ECDH key exchange and AES-GCM
- **Decentralized Messaging**: Peer-to-peer communication via Gun.js network
- **Real-time Communication**: Instant message delivery and presence detection
- **Government ID Verification**: PAN card verification for enhanced security
- **Cryptocurrency Market Data**: Real-time crypto prices and charts
- **Profile Management**: Customizable user profiles with avatars
- **Message History**: Persistent local storage with cloud backup

### ğŸ› ï¸ Technology Stack

- **Frontend**: React 18, TypeScript, Tailwind CSS
- **Authentication**: Supabase Auth with wallet integration
- **Database**: Supabase PostgreSQL with Row Level Security
- **P2P Network**: Gun.js for decentralized messaging
- **Encryption**: Web Crypto API (ECDH + AES-GCM)
- **Wallet Integration**: MetaMask via ethers.js
- **Charts**: Lightweight Charts for market data
- **Deployment**: Netlify

### ğŸ“‹ Prerequisites

- Node.js 18+ and npm
- MetaMask browser extension
- Modern web browser with Web Crypto API support

### ğŸ”§ Installation

1. **Clone the repository**
   ```bash
   git clone <repository-url>
   cd kraken-messaging
   ```

2. **Install dependencies**
   ```bash
   npm install
   ```

3. **Environment Setup**
   Create a `.env` file with your Supabase credentials:
   ```env
   VITE_SUPABASE_URL=your_supabase_url
   VITE_SUPABASE_ANON_KEY=your_supabase_anon_key
   ```

4. **Database Setup**
   - Create a new Supabase project
   - Run the migration files in the `supabase/migrations` folder
   - Ensure Row Level Security is enabled

5. **Start Development Server**
   ```bash
   npm run dev
   ```

### ğŸš€ Deployment

The application is deployed on Netlify at: https://resonant-unicorn-0d783d.netlify.app

To deploy your own instance:
1. Build the project: `npm run build`
2. Deploy the `dist` folder to your hosting provider
3. Configure environment variables on your hosting platform

### ğŸ” Security Features

- **End-to-End Encryption**: All messages are encrypted client-side
- **Key Management**: ECDH key pairs generated per user
- **Perfect Forward Secrecy**: Unique encryption keys per conversation
- **Wallet Signatures**: Message authenticity via wallet signatures
- **Row Level Security**: Database access controlled by user authentication

### ğŸ“± Usage

1. **Connect Wallet**: Click "Connect with MetaMask" and approve the connection
2. **Choose Authentication**: Select "Sign Up" for new users or "Login" for existing users
3. **ID Verification**: Complete PAN card verification (for new users)
4. **Start Messaging**: Navigate to Messages and enter a recipient's wallet address
5. **Send Messages**: Choose between encrypted or unencrypted messages
6. **View Profile**: Manage your profile settings and avatar

### ğŸ”§ Configuration

#### Gun.js Peers
The application automatically discovers live Gun.js peers for optimal connectivity. You can modify the peer list in `src/lib/messagingService.ts`.

#### Encryption Settings
Encryption is enabled by default but can be toggled per message. The system uses:
- **ECDH P-256** for key exchange
- **AES-GCM 256-bit** for message encryption
- **Random IV** for each encrypted message

### ğŸ› Troubleshooting

#### Common Issues:

1. **Messages not sending**: Check Gun.js peer connectivity and internet connection
2. **Encryption failures**: Ensure both users have published their public keys
3. **Authentication issues**: Verify Supabase configuration and wallet connection
4. **Database errors**: Check RLS policies and user permissions

#### Debug Mode:
Enable console logging by opening browser developer tools to see detailed connection and encryption status.

### ğŸ¤ Contributing

1. Fork the repository
2. Create a feature branch: `git checkout -b feature-name`
3. Commit changes: `git commit -m 'Add feature'`
4. Push to branch: `git push origin feature-name`
5. Submit a pull request

### ğŸ“„ License

This project is licensed under the MIT License - see the LICENSE file for details.

### ğŸ‘¨â€ğŸ’» Author

**Za.i.14** - Creator and Lead Developer

### ğŸ™ Acknowledgments

- Gun.js team for the decentralized database
- Supabase for the backend infrastructure
- MetaMask for wallet integration
- CoinGecko for cryptocurrency market data

### ğŸ“ Support

For support and questions:
- Open an issue on GitHub
- Contact the development team
- Check the documentation for common solutions

---

*Built with â¤ï¸ for the decentralized web*